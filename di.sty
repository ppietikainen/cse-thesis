%
% Template for Department of Electrical and Information Engineering
% Diploma Thesis v1.1.2013
% Authors: Mika Korhonen (original author), Pekka Pietikäinen,
% Christian Wieser, Teemu Tokola, Juha Kylmänen, Tuomas Holmberg and
% Tuomas Varanka.
% If you make any improvements to this template, please contact
% teemu.tokola@oulu.fi
%
% CHANGELOG
% 2023-01-31: Thnks to Miika Sikala
%   row 133: \dichapter{\texorpdfstring{\MakeUppercase{#1}}{}} -->
% \dichapter{\texorpdfstring{\MakeUppercase{#1}}{#1}}
%   row 136: \dichapter*{\texorpdfstring{\MakeUppercase{#1}}{}} -->
% \dichapter*{\texorpdfstring{\MakeUppercase{#1}}{#1}}
%   row 217:
% \renewcommand{\section}[1]{\oldsection{\texorpdfstring{\titlecap{##1}}{}}{}}
% -->
% \renewcommand{\section}[1]{\oldsection{\texorpdfstring{\titlecap{##1}}{##1}}{}}
%   row 218:
% \renewcommand{\subsection}[1]{\oldsubsection{\texorpdfstring{\titlecap{##1}}{}}{}}
% -->
% \renewcommand{\subsection}[1]{\oldsubsection{\texorpdfstring{\titlecap{##1}}{##1}}{}}
% 2023-01-31: Track changes has been turned on -TTo
%
\ProvidesPackage{di}

% --- Encoding and fonts: Required for correct character rendering and thesis typography ---
\usepackage[utf8]{inputenc}      % UTF-8 encoding for international characters
\usepackage[T1]{fontenc}         % Output font encoding for accented characters
\usepackage{lmodern}             % Latin Modern font as required by thesis typography
\usepackage{newtxtext, newtxmath} % Improved text and math font for readability

% --- Language and hyphenation ---
\usepackage[english,finnish]{babel} % Support for English and Finnish thesis (main.tex)
\usepackage[english=nohyphenation,finnish=nohyphenation]{hyphsubst} % No hyphenation per instructions

% --- Typography, layout, and sectioning ---
\usepackage{titlesec}            % Custom section/chapter formatting (font size, bold, spacing)
\usepackage{titletoc}            % Custom table of contents formatting
\usepackage{titlecaps}           % Title capitalization for headings as per instructions
\usepackage{etoolbox}            % Utility for macro programming (used in title formatting)
\usepackage{enumitem}            % Customization of itemize/enumerate (bullet style per instructions)
\usepackage{chngcntr}            % For resetting counters (figures/tables per chapter)
\usepackage{tocloft}             % Customization of TOC/LOF/LOT appearance

% --- Figures, tables, and floats ---
\usepackage{graphicx}            % Required for including figures
\usepackage{float}               % Improved float placement (figures/tables as per instructions)
\usepackage{placeins}            % Ensures floats stay within chapters/sections
\usepackage{tabularx}            % Flexible tables (table layout as per instructions)
\usepackage{longtable}           % Tables spanning multiple pages
\usepackage{subcaption}          % Subfigures/subtables
\usepackage{multirow}            % Multirow cells in tables
\usepackage{fancybox}            % For boxed content (used in some thesis layouts)
\usepackage{verbatim}            % For including verbatim text/code

% --- Math and symbols ---
\usepackage{amsfonts}            % Additional math fonts (for equations, as per instructions)

% --- Algorithms ---
\usepackage[linesnumbered, ruled]{algorithm2e} % For writing algorithms (see writing instructions)

% --- Bibliography ---
\usepackage[backend=biber,
  style=ieee,
  doi=true,
  urldate=long,
  url=true]{biblatex}            % IEEE bibliography style, running numbering, BibLaTeX as required

% --- Date and time ---
\usepackage[useregional=text, british]{datetime2} % Date formatting for title page and signature

% --- Quoting and citations ---
\usepackage{csquotes}            % Recommended for correct quotation marks in citations

% --- Utility and color profiles ---
\usepackage{import}              % For importing files (used in some thesis structures)
\usepackage{colorprofiles}       % For PDF/A compliance (required for electronic thesis submission)

\newcommand{\thesislanguage}{english}

\RequirePackage{ifthen, xstring}

\newcounter{NAllPages}
\newcounter{NMainTxtPages}
\newcounter{NAppdxPages}
\newcommand*{\stor@maintxtpag@number}{%
  \immediate\write\@auxout{\string\setcounter{NMainTxtPages}{\thepage-1}}%
}

\newcommand{\startappendix}{%
\stor@maintxtpag@number%
}

\AtEndDocument{%
  \immediate\write\@auxout{\string\setcounter{NAllPages}{\thepage}}%
}

\newcommand*{\shownumberofpages}{%
  \arabic{NAllPages}
%  \ifthenelse{\value{NMainTxtPages}=0}{\arabic{NAllPages}}%
%  \ifnumequal{\value{NMainTxtPages}}{0}{\arabic{NAllPages}}%
% 	{\arabic{NMainTxtPages}+\arabic{NAppdxPages}}%
}%


% --- Miscellaneous ---
\tolerance=500                   % Typographic tolerance (for line breaking)

\setlist[itemize,1]{label=\raisebox{0.2ex}{\tiny$\bullet$}}
\setlist[itemize,2]{label=\raisebox{0.2ex}{\tiny$\bullet$}}

\DefineBibliographyStrings{finnish}{
  chapter      = luku,
  editor       = toim\adddot,
  editors      = toim\adddot,
  mathesis     = Pro gradu -tutkielma,
  patentjp     = Japanin patentti,
  patentus     = Yhdysvaltain patentti,
  phdthesis    = Väitöskirja,
  presentedat  = esitetty,
  techreport   = Tekninen raportti,
  url          = [Online]\adddot\addspace Saatavilla,
  urlseen      = Viitattu\addcolon
}

\NeedsTeXFormat{LaTeX2e}
\RequirePackage{appendix}
\renewcommand{\thechapter}{Appendix \arabic{chapter}}  % Custom numbering
\renewcommand{\appendixname}{Appendix}

\RequirePackage{chngcntr}
\counterwithout{figure}{chapter}
\counterwithout{table}{chapter}

\RequirePackage{ifthen, xstring}

\RequirePackage{tocloft}
\setlength{\cftchapnumwidth}{3em}
\setlength{\cftbeforechapskip}{1em}

\widowpenalty10000
\clubpenalty10000
\displaywidowpenalty10000
\hbadness=99999
\graphicspath{{Figures/}{../Figures/}}
\counterwithout{footnote}{chapter}

\newtoggle{writexmpdatafile}

\toggletrue{writexmpdatafile}

\newcommand{\CopyrightText}{}% variable; used for printing on page
\newcommand{\MetaCopyrightText}{}%
\newcommand{\pdfCopyrightURL}{}%
\newcommand{\copyrighttext}[2]{%
  \renewcommand{\MetaCopyrightText}{#1}%
  \renewcommand{\CopyrightText}{#2}%
  \ifdef{\doclicenseURL}{\renewcommand{\pdfCopyrightURL}{\doclicenseURL}}{}%
}%

\RequirePackage[a-1b,latxmp, mathxmp]{pdfx}[2017/05/18]% Produces PDF/A 1b, 2b and 3b
                                           % compliant pdf
\RequirePackage{newfile}% Provides an easy interface for writing data into new
% file (used to write metadata into file .xmpdata)

\newcommand*{\spc}{\noexpand\sep}%

\newcommand{\makemetadata}{%
  \iftoggle{writexmpdatafile}{%
    % Write the metadata into file .xmpdata, which is included in the PDF/A file
	\newoutputstream{xmpdata}%
	\openoutputfile{\jobname.xmpdata}{xmpdata}%
	\addtostream{xmpdata}{\noexpand\Title {\maintitle}}%
	\addtostream{xmpdata}{\noexpand\Author {\getauthorsmetadata}}%
  \addtostream{xmpdata}{\noexpand\Copyright {\MetaCopyrightText}}%%
 	\addtostream{xmpdata}{\noexpand\CopyrightURL {\pdfCopyrightURL}}
	\addtostream{xmpdata}{\noexpand\Subject {\englishabstract}}%
	%\addtostream{xmpdata}{\noexpand\Keywords {\keywords}}%
	\closeoutputstream{xmpdata}%
  }{%
    % Write the metadata directly into the pdf file via hyperref keywords
	%\renewcommand*{\spc}{; }%
	%\hypersetup{%
	%  pdftitle={\maintitle},%
	%  pdfauthor={\ThesisAuthor},%
	%  pdfsubject={\abstracttext},%
	%  pdfcopyright={\MetaCopyrightText},%
	%  pdfkeywords={\keywords}%
	%}%
  }%
}%
%
\AtBeginDocument{%
  \makemetadata%
}%
%


% Change these "excluded words" if you are not satisfied with titlecaps
%http://perspectivesandprotips.blogspot.com/2014/11/using-macros-with-titlecaps-in-latex.html
\Resetlcwords
\Addlcwords{a an the}
\Addlcwords{and but for or nor}
\Addlcwords{aboard about above across %
  after against along amid among anti %
  around as at behind below % before
  beneath beside besides between %
  beyond but by concerning considering %
  despite down during except excepting %
  excluding following for from in %
  inside into like minus near of off %
  on onto opposite outside over past %
  per plus regarding round since % save
  than through to toward towards under %
  underneath unlike until up upon %
versus via with within without}

\setcounter{secnumdepth}{3} % numbers up to \subsubsection by default

% Chapter
% Commentary: Chapters are set in 14pt bold (bfseries), centered, uppercase. No space before, one baseline skip after.
\titleformat{\chapter}
  [hang]
  {\normalfont\bfseries\fontsize{14}{17}\selectfont\centering}
  {\thechapter.}
  {1em}
  {\MakeUppercase}
\titlespacing*{\chapter}{0pt}{0pt}{\baselineskip}

% Section
% Commentary: Sections are 12pt bold (bfseries), left-aligned, normal font, with 2 baseline skips before and 1 after.
\titleformat{\section}
  [hang]
  {\normalfont\bfseries\fontsize{12}{15}\selectfont}
  {\thesection.}
  {1em}
  {}
% (Spacing is set in \@startsection: 2\baselineskip before, \baselineskip after.)

% Subsection
% Commentary: Subsections are bold italic (bfseries, itshape), normal font size, with 2 baseline skips before and 1 after.
\titleformat{\subsection}
  [hang]
  {\normalfont\bfseries\itshape}
  {\thesubsection.}
  {1em}
  {}
% (Spacing is set in \@startsection: 2\baselineskip before, \baselineskip after.)

% Subsubsection
% Commentary: Subsubsections are italic (itshape), normal font size, with 2 baseline skips before and 1 after.
\titleformat{\subsubsection}
  [hang]
  {\normalfont\itshape}
  {\thesubsubsection.}
  {1em}
  {}
% --------------------
% Add period after number in TOC entries
% --------------------

\renewcommand{\cftchapaftersnum}{.}
\renewcommand{\cftsecaftersnum}{.}
\renewcommand{\cftsubsecaftersnum}{.}
\renewcommand{\cftsubsubsecaftersnum}{.}

%decimal comma
\DeclareMathSymbol{,}{\mathpunct}{letters}{"3B}
\DeclareMathSymbol{.}{\mathord}{letters}{"3B}
%\DeclareMathSymbol{\decimal}{\mathord}{letters}{"3A}

%chapter styles
%
% Inspired from here:
% http://tex.stackexchange.com/questions/73242/problem-with-redefining-chapter-command

\renewcommand{\thechapter}{\arabic{chapter}}

\renewcommand{\section}{
  \@startsection
  {section}%
  {1}%
  {0mm}%
  {2\baselineskip}%
  {\baselineskip}%
{\normalfont\normalsize\bfseries\centering}}%

\renewcommand{\thesection}{\arabic{chapter}.\arabic{section}}%

\renewcommand{\subsection}{
  \@startsection
  {subsection}%
  {2}%
  {0mm}%
  {2\baselineskip}%
  {\baselineskip}%
{\normalfont\normalsize\bfseries\itshape\centering}}%

\renewcommand{\thesubsection}{\arabic{chapter}.\arabic{section}.\arabic{subsection}}%

\newcommand{\firstname}[1]{\gdef\@firstname{#1}}
\newcommand{\lastname}[1]{\gdef\@lastname{#1}}
\newcommand{\firstnametwo}[1]{\gdef\@firstnametwo{#1}}
\newcommand{\lastnametwo}[1]{\gdef\@lastnametwo{#1}}
\newcommand{\firstnamethree}[1]{\gdef\@firstnamethree{#1}}
\newcommand{\lastnamethree}[1]{\gdef\@lastnamethree{#1}}
\newcommand{\otsikko}[1]{\gdef\@otsikko{#1}
\gdef\@isotsikko{\MakeUppercase{#1}}}

\newcommand{\getfirstname}{\@firstname}
\newcommand{\getlastname}{\@lastname}
\newcommand{\getfirstnametwo}{\@firstnametwo}
\newcommand{\getlastnametwo}{\@lastnametwo}
\newcommand{\getfirstnamethree}{\@firstnamethree}
\newcommand{\getlastnamethree}{\@lastnamethree}
\newcommand{\getotsikko}{\@otsikko}
\newcommand{\gettitle}{\@title}

\newcommand{\lskip}[1][]{\vspace{#1\baselineskip}\noindent}

\newcommand{\printavainsanat}{\lskip Avainsanat: \avainsanat}
\newcommand{\printkeywords}{\lskip Keywords: \keywords}

\newcommand{\thesis}[1]{\gdef\@thesis{#1}}
\newcommand{\getthesis}{\@thesis}

\newcommand{\headertitlecap}{
  \ifthenelse{\equal{\thesislanguage}{english}}{
    \let\oldsection\section
    \let\oldsubsection\subsection
    \renewcommand{\section}[1]{\oldsection{\texorpdfstring{\titlecap{##1}}{##1}}}
    \renewcommand{\subsection}[1]{\oldsubsection{\texorpdfstring{\titlecap{##1}}{##1}}}
  }{}
}

\newcommand{\facultyname}{}
\newcommand{\degreeprogramme}{}
\newcommand{\thesistypetitle}{}
\newcommand{\maintitle}{}
\newcommand{\universityname}{}
\newcommand{\pagelabel}{}
\newcommand{\headerforeword}{}
\newcommand{\headerabbreviations}{}
\newcommand{\tocname}{}
\newcommand{\mybibname}{}
\newcommand{\cityname}{}
\newcommand{\universitylogo}{Figures/logo-en.png}

\newcommand{\keywords}{}
\newcommand{\avainsanat}{}
\newcommand{\allkeywords}{\keywords, \avainsanat}

% Add macros for thesis type in English and Finnish
\newcommand{\thesistypeenglish}{%
  \ifthenelse{\equal{\@thesis}{Master}}{Master's thesis}{Bachelor's thesis}%
}
\newcommand{\thesistypefinnish}{%
  \ifthenelse{\equal{\@thesis}{Master}}{Diplomityö}{Kandidaatintyö}%
}

\ifthenelse{\equal{\thesislanguage}{finnish}}{%
  \renewcommand{\facultyname}{TIETO- JA SÄHKÖTEKNIIKAN TIEDEKUNTA}
  \renewcommand{\degreeprogramme}{Tietotekniikan tutkinto-ohjelma}
  \renewcommand{\thesistypetitle}{\thesistypefinnish}
  \renewcommand{\maintitle}{@otsikko}
  \renewcommand{\universityname}{Oulun yli\-opis\-to}
  \renewcommand{\pagelabel}{s.}
  \renewcommand{\headerforeword}{ALKULAUSE}
  \renewcommand{\headerabbreviations}{LYHENTEIDEN JA MERKKIEN SELITYKSET}
  \renewcommand{\tocname}{SISÄLLYSLUETTELO}
  \renewcommand{\mybibname}{VIITTEET}
  \renewcommand{\cityname}{Oulussa }
  \renewcommand{\universitylogo}{Figures/logo-fi.png}
}{
  \renewcommand{\facultyname}{FACULTY OF INFORMATION TECHNOLOGY AND
  ELECTRICAL ENGINEERING}
  \renewcommand{\degreeprogramme}{Degree Programme in Computer
  Science and Engineering}
  \renewcommand{\thesistypetitle}{\thesistypeenglish}
  \renewcommand{\maintitle}{\@title}
  \renewcommand{\universityname}{University of Oulu}
  \renewcommand{\pagelabel}{p.}
  \renewcommand{\headerforeword}{FOREWORD}
  \renewcommand{\headerabbreviations}{LIST OF ABBREVIATIONS AND SYMBOLS}
  \renewcommand{\tocname}{TABLE OF CONTENTS}
  \renewcommand{\mybibname}{REFERENCES}
  \renewcommand{\cityname}{Oulu, }
}

% --- End centralized definitions ---

%Title page
% Commentary: The title page is generated by \maketitlepage. Ensure correct faculty, degree, and title.
\newcommand{\maketitlepage}{
  \sloppy
  \ifthenelse{\equal{\thesislanguage}{finnish}}{
    \selectlanguage{finnish}
  } {
    \selectlanguage{english}
  }
  \begin{titlepage}
    \centering
    \includegraphics*[width=0.22\textwidth]{\universitylogo}\\
    {\sffamily\fontsize{8}{10pt}\selectfont \facultyname\\}
    \vspace{70 mm}
    {\textbf{\fontsize{16}{19pt}\selectfont \getauthorstitle}\\}
    \vspace{12 mm}
    {\textbf{\fontsize{18}{22pt}\selectfont \MakeUppercase{\maintitle} \\}}
    \vfill
    {\fontsize{14}{17}\selectfont \thesistypetitle
    \\ \degreeprogramme \\ \DTMToday \\}
    \vspace{1cm}
  \end{titlepage}
  \cleardoublepage
  \pagenumbering{gobble}
}
\newcommand{\makecopyrightpage}{%
  \newpage
  \thispagestyle{empty}%
  \noindent%
  \CopyrightText\par%
  \cleardoublepage
}%

\addtocontents{toc}{\protect\thispagestyle{empty}}
%Table of contents
% Commentary: Use \contents to generate the table of contents. Only chapters from Introduction onwards are numbered.
\newcommand{\contents}{
  \newpage
  \renewcommand{\contentsname}{\tocname}%
  \addtocontents{toc}{\protect\contentsline{chapter}{\tocname}{}{page.\thepage}
  }
  \newlength{\temp}
  \setlength{\temp}{\parskip}
  \setlength{\parskip}{0mm}
  \tableofcontents
  \setlength{\parskip}{\temp}
}

\setcounter{tocdepth}{2}
\renewcommand{\cfttoctitlefont}{\hfill\normalfont\large\bfseries}
\renewcommand{\cftaftertoctitle}{\hfill\hfill}
\renewcommand{\cftchapfont}{}
\renewcommand{\cftchappagefont}{}
\setlength{\cftbeforechapskip}{0mm}
\setlength{\cftbeforetoctitleskip}{0mm}
\setlength{\cftaftertoctitleskip}{8mm}
\renewcommand{\cftdotsep}{0.2}

\newenvironment{abstractpage}[2]{%
  \newpage
  \addtocontents{toc}{\protect\contentsline{chapter}{#1}{}{page.\thepage}}
  % Metadata first (not bold)
  {#2\par\vspace{2em}}
  % Heading, carefully scoped to avoid leaking bold style
  {\begingroup
    \centering
    \normalfont\bfseries\fontsize{14}{17}\selectfont
    \MakeUppercase{#1}\par
    \endgroup
    \vspace{1em}
  }
}{}

\newcommand{\englishabstractmetadata}{%
  {\textbf{\getauthorsabstractacta\ (\the\year) \titlecap{\@title}}. University of Oulu, Degree Programme in Computer Science and Engineering, \shownumberofpages~p.}
}

% Finnish metadata
\newcommand{\finnishabstractmetadata}{%
  {\textbf{\getauthorsabstractacta\ (\the\year) \@otsikko}. Oulun yli\-opis\-to, Tietotekniikan tutkinto-ohjelma, \shownumberofpages~s.}
}

% Shortcut commands
\newcommand{\abstractenglish}{}
\newcommand{\abstractfinnish}{\begin{abstractpage}{TIIVISTELMÄ}{\finnishabstractmetadata}}

\newcommand{\englishabstractmetadataieee}{%
  {\getauthorsabstractieee, ``\titlecap{\@title},'' \thesistypeenglish, Dept. of Computer Science, Univ. of Oulu, Oulu, Finland, \the\year.}
}

\newcommand{\finnishabstractmetadataieee}{%
  {\getauthorsabstractieee, ``\@otsikko,'' \thesistypefinnish, Tietotekniikan koulutusohjelma, Oulun yliopisto, Oulu, Suomi, \the\year.}
}


% Commands to print abstracts
\newcommand{\printabstract}{%
  \selectlanguage{english}
  \setcounter{NAppdxPages}{\value{NAllPages}-\value{NMainTxtPages}}
  \begin{abstractpage}{ABSTRACT}{\englishabstractmetadata}
    {\bfseries \englishabstract

    \printkeywords}
  \end{abstractpage}
}

\newcommand{\printtiivistelma}{%
\selectlanguage{finnish}  
\setcounter{NAppdxPages}{\value{NAllPages}-\value{NMainTxtPages}}
\begin{abstractpage}{TIIVISTELMÄ}{\finnishabstractmetadata}
    {\bfseries \finnishabstract

    \printavainsanat}
\end{abstractpage}
}

%chapters without page numbering
\newcommand{\header}[1]{
  \chapter*{#1}
\addtocontents{toc}{\protect\contentsline{chapter}{#1}{}{page.\thepage} }}



%page margins, and spacing
\oddsidemargin 1.96cm      % left margin = 4.5 cm
\evensidemargin 1.96cm
\topmargin -0.71cm      % top margin = 2.5 cm
\textheight 24.2cm   

%page numbering
\pagestyle{empty}

\newcommand{\pagenumbers}{
  \pagestyle{myheadings}
  \makeatletter
  \def\ps@plain{\ps@myheadings} % plain pages like chapters also top right
  \makeatother
} 

%indentation and spacing between chapters

%\parskip\baselineskip
\parindent0.5cm

%dont indent the first row
\let\@afterindenttrue\@afterindentfalse
\@afterindentfalse

%figures and tables
\renewcommand{\thefigure}%numerilization
{\arabic{figure}}

\renewcommand{\thetable}
{\arabic{table}}

\captionsetup[table]{position=above, justification=raggedright, singlelinecheck=off}

\renewcommand{\@makecaption}[2]{%
  \vskip\abovecaptionskip
  \sbox\@tempboxa{#1. #2}%
  \ifdim \wd\@tempboxa >\hsize
  #1. #2\par
  \else
  \global \@minipagefalse
  \hb@xt@\hsize{\hfil\box\@tempboxa\hfil}
  \fi
\vskip\belowcaptionskip}

\newsavebox{\TmpCaption}
\newcommand{\TmpLabel}{}

\newenvironment{kuva}[2]
{
  \begin{figure}[ht]
    \begin{center} \sbox{\TmpCaption}{#1}
    \renewcommand{\TmpLabel}{\label{#2}}}
    {\caption{\usebox{\TmpCaption}} \TmpLabel
    \end{center}
    \vspace{-\baselineskip}
\end{figure}}

\newenvironment{taulukko}[2]
{
  \begin{table}[ht]
  \begin{center} \caption{#1} \label{#2} }
    {
    \end{center} \vspace{-\baselineskip}
\end{table}}

%equations
\renewcommand{\theequation}{\arabic{equation}}

%bibliography
\renewenvironment{thebibliography}[1]
{\chapter{\mybibname}
  \list{\@biblabel{\@arabic\c@enumiv}}%
  {\settowidth\labelwidth{\@biblabel{#1}}%
    \leftmargin\labelwidth
    \advance\leftmargin\labelsep
    \@openbib@code
    \usecounter{enumiv}%
    \let\p@enumiv\@empty
  \renewcommand\theenumiv{\@arabic\c@enumiv}}%
  \sloppy
  \clubpenalty4000
  \@clubpenalty \clubpenalty
  \widowpenalty4000%
\sfcode`\.\@m}
{\def\@noitemerr
  {\@latex@warning{Empty `thebibliography' environment}}%
\endlist}

% caption
\setlength\abovecaptionskip{0\p@} %\setlength\abovecaptionskip{\f@size\p@}
\setlength\belowcaptionskip{0\p@}
\long\def\@makecaption#1#2{%
  \vskip\abovecaptionskip
  \sbox\@tempboxa{#1. #2}%
  \ifdim \wd\@tempboxa >\hsize
  #1. #2\par
  \else
  \global \@minipagefalse
  \hb@xt@\hsize{\hfil\box\@tempboxa\hfil}%
  \fi
\vskip\belowcaptionskip}

% algorithm
%\renewcommand{\@algocf@capt@plain}{above}
%\renewcommand{\algocf@caption@plain}{\box\algocf@capbox\vskip\AlCapSkip}
\SetAlCapSty{}
\SetAlgoCaptionSeparator{.}
%\SetAlCapSkip{2mm}

%get authors for the title page
\newcommand{\getauthorstitle}{
  \begin{tabular}[t]{c}
  \getauthors{\\}%   
  \end{tabular}
}

\newcommand{\getauthorsmetadata}{
  \getauthors{\spc }%
}

% Returns the list of authors, separated by \sep
\newcommand{\getauthors}[1]{%
  \@ifempty{\@firstnametwo}{%
    \getfirstname\ \getlastname%
  }{%
    \@ifempty{\@firstnamethree}{%
      \getfirstname\ \getlastname#1\getfirstnametwo\ \getlastnametwo%
    }{%
      \getfirstname\ \getlastname#1\getfirstnametwo\ \getlastnametwo#1\getfirstnamethree\ \getlastnamethree%
    }%
  }%
}

%get authors for the abstract (Acta style: Surname F.)
\newcommand{\getauthorsabstractacta}{%
  \ifthenelse{\equal{\@firstnametwo}{}}%
    {\noindent \bf \@lastname\ \StrChar{\@firstname}{1}.}%
    {\ifthenelse{\equal{\@firstnamethree}{}}%
      {\noindent \bf \@lastname\ \StrChar{\@firstname}{1}.,\ %
        \@lastnametwo\ \StrChar{\@firstnametwo}{1}. \ignorespaces}%
      {\noindent \bf \@lastname\ \StrChar{\@firstname}{1}.,\ %
        \@lastnametwo\ \StrChar{\@firstnametwo}{1}.,\ %
        \@lastnamethree\ \StrChar{\@firstnamethree}{1}. \ignorespaces}%
    }%
}

%get authors for the abstract (IEEE style: F. Lastname)
\newcommand{\getauthorsabstractieee}{%
  \ifthenelse{\equal{\@firstnametwo}{}}%
    {\noindent \StrChar{\@firstname}{1}.\ \@lastname}%
    {\ifthenelse{\equal{\@firstnamethree}{}}%
      {\noindent \StrChar{\@firstname}{1}.\ \@lastname,\ %
        \StrChar{\@firstnametwo}{1}.\ \@lastnametwo \ignorespaces}%
      {\noindent \StrChar{\@firstname}{1}.\ \@lastname,\ %
        \StrChar{\@firstnametwo}{1}.\ \@lastnametwo,\ %
        \StrChar{\@firstnamethree}{1}.\ \@lastnamethree \ignorespaces}%
    }%
}

% For backward compatibility, keep the original macro name as Acta style
\let\getauthorsabstract\getauthorsabstractacta

%signature at the bottom of foreword
\newcommand{\signature}{
  \DTMlangsetup[en-GB]{monthyearsep={,\space}}
  \par\lskip[1]\hspace{0.0cm}
  \begin{flushleft} \cityname \DTMToday
  \end{flushleft}
  \par \lskip[0]\hspace{0.0cm}
  \ifthenelse{\equal{\@firstnametwo}{}}
  {
    \begin{flushleft} \@firstname\ \@lastname
  \end{flushleft}}
  {\ifthenelse{\equal{\@firstnamethree}{}}
    {
      \begin{flushleft}
        \@firstname\ \@lastname\\
        \@firstnametwo\ \@lastnametwo
      \end{flushleft}
    }
    {
      \begin{flushleft}
        \@firstname\ \@lastname\\
        \@firstnametwo\ \@lastnametwo\\
        \@firstnamethree\ \@lastnamethree
      \end{flushleft}
    }
  }
}

\g@addto@macro{\normalsize}{%
  \setlength{\abovedisplayskip}{0pt}
  \setlength{\abovedisplayshortskip}{0pt}
  \setlength{\belowdisplayskip}{12pt}
\setlength{\belowdisplayshortskip}{12pt}}
\makeatother

% Moved from dithesis.cls, eqref is from amsmath so renew
\newcommand{\figref}[1]{Figure~\ref{#1}}
\renewcommand{\eqref}[1]{Equation~(\ref{#1})}
\newcommand{\tabref}[1]{Table~\ref{#1}}
\newcommand{\charef}[1]{Chapter~\ref{#1}}
\newcommand{\secref}[1]{Section~\ref{#1}}

%
%% Creative Commons license Finnish translations for use with doclicense.sty.
%% To be removed when Finnish is supported by doclicense. 
\newcommand{\MyMetadataText}{\doclicense@lang@thisDoc \ \doclicense@type \ \doclicense@modifier \ \doclicense@version \ \doclicense@lang@word@license}
%

